77u/cGFja2FnZSBuZXQuY2hhb3NjcmFmdC5wY191aS5jbGllbnQuYXBwOwoKaW1w
b3J0IGNvbS5tb2phbmcuYmxhemUzZC52ZXJ0ZXguUG9zZVN0YWNrOwppbXBvcnQg
bmV0Lm1pbmVjcmFmdC5jbGllbnQuTWluZWNyYWZ0OwppbXBvcnQgbmV0Lm1pbmVj
cmFmdC5jbGllbnQuZ3VpLkd1aUdyYXBoaWNzOwppbXBvcnQgbmV0Lm1pbmVjcmFm
dC5jbGllbnQuZ3VpLmNvbXBvbmVudHMuRWRpdEJveDsKaW1wb3J0IG5ldC5taW5l
Y3JhZnQuY2xpZW50LnJlc291cmNlcy5zb3VuZHMuU2ltcGxlU291bmRJbnN0YW5j
ZTsKaW1wb3J0IG5ldC5taW5lY3JhZnQubmV0d29yay5jaGF0LkNvbXBvbmVudDsK
aW1wb3J0IG5ldC5taW5lY3JhZnQuc291bmRzLlNvdW5kRXZlbnRzOwppbXBvcnQg
bmV0LmNoYW9zY3JhZnQucGNfdWkuY2xpZW50LmFzeW5jLkFzeW5jVGFza01hbmFn
ZXI7CmltcG9ydCBuZXQuY2hhb3NjcmFmdC5wY191aS5jbGllbnQuZnMuRmlsZXNN
YW5hZ2VyOwppbXBvcnQgbmV0LmNoYW9zY3JhZnQucGNfdWkuY2xpZW50LnNjcmVl
bi5EcmFnZ2FibGVXaW5kb3c7CgppbXBvcnQgamF2YS5pby5GaWxlOwppbXBvcnQg
amF2YS5pby5GaWxlV3JpdGVyOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK
aW1wb3J0IGphdmEuaW8uV3JpdGVyOwppbXBvcnQgamF2YS5uaW8uZmlsZS5GaWxl
czsKaW1wb3J0IGphdmEubmlvLmZpbGUuU3RhbmRhcmRPcGVuT3B0aW9uOwppbXBv
cnQgamF2YS51dGlsLkFycmF5RGVxdWU7CmltcG9ydCBqYXZhLnV0aWwuRGVxdWU7
CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5M
aXN0OwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuYXRvbWljLkF0b21pY0Jv
b2xlYW47CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5hdG9taWMuQXRvbWlj
UmVmZXJlbmNlOwoKcHVibGljIGNsYXNzIE5vdGVwYWRBcHAgaW1wbGVtZW50cyBJ
QXBwIHsKICAgIHByaXZhdGUgRHJhZ2dhYmxlV2luZG93IHdpbmRvdzsKICAgIHBy
aXZhdGUgZmluYWwgQXN5bmNUYXNrTWFuYWdlciBhc3luY01hbmFnZXIgPSBBc3lu
Y1Rhc2tNYW5hZ2VyLmdldEluc3RhbmNlKCk7CgogICAgcHJpdmF0ZSBFZGl0Qm94
IHRleHRBcmVhOwogICAgcHJpdmF0ZSBmaW5hbCBBdG9taWNSZWZlcmVuY2U8Rmls
ZT4gY3VycmVudEZpbGUgPSBuZXcgQXRvbWljUmVmZXJlbmNlPD4obnVsbCk7CiAg
ICBwcml2YXRlIGZpbmFsIEF0b21pY0Jvb2xlYW4gaXNNb2RpZmllZCA9IG5ldyBB
dG9taWNCb29sZWFuKGZhbHNlKTsKCiAgICBwcml2YXRlIGRvdWJsZSBtb3VzZVJl
bFgsIG1vdXNlUmVsWTsKCiAgICAvLyBTYXZlIGRpYWxvZwogICAgcHJpdmF0ZSBi
b29sZWFuIHNob3dTYXZlRGlhbG9nID0gZmFsc2U7CiAgICBwcml2YXRlIEVkaXRC
b3ggc2F2ZUZpbGVOYW1lSW5wdXQ7CiAgICBwcml2YXRlIEVkaXRCb3ggZmlsZVBh
dGhJbnB1dDsKCiAgICAvLyBPcGVuIGRpYWxvZyBzdGF0ZQogICAgcHJpdmF0ZSBi
b29sZWFuIHNob3dPcGVuRGlhbG9nID0gZmFsc2U7CiAgICBwcml2YXRlIEVkaXRC
b3ggb3BlbkZpbGVOYW1lSW5wdXQ7CiAgICBwcml2YXRlIEVkaXRCb3ggb3BlbkZp
bGVQYXRoSW5wdXQ7CiAgICAvLyBTYXZlLW9uLWV4aXQgZGlhbG9nIHN0YXRlCiAg
ICBwcml2YXRlIGJvb2xlYW4gc2hvd1NhdmVPbkV4aXREaWFsb2cgPSBmYWxzZTsK
CiAgICAvLyBVbmRvL3JlZG8KICAgIHByaXZhdGUgZmluYWwgRGVxdWU8U3RyaW5n
PiB1bmRvU3RhY2sgPSBuZXcgQXJyYXlEZXF1ZTw+KCk7CiAgICBwcml2YXRlIGZp
bmFsIERlcXVlPFN0cmluZz4gcmVkb1N0YWNrID0gbmV3IEFycmF5RGVxdWU8Pigp
OwoKICAgIC8vIFJlY2VudCBmaWxlcwogICAgcHJpdmF0ZSBmaW5hbCBMaW5rZWRM
aXN0PFN0cmluZz4gcmVjZW50RmlsZXMgPSBuZXcgTGlua2VkTGlzdDw+KCk7CiAg
ICBwcml2YXRlIGZpbmFsIEZpbGUgcmVjZW50RmlsZXNGaWxlID0gbmV3IEZpbGUo
RmlsZXNNYW5hZ2VyLmdldFBsYXllckRhdGFEaXIoKSwgIm5vdGVwYWRfcmVjZW50
LnR4dCIpOwoKICAgIHByaXZhdGUgU3RyaW5nIHN0YXR1c01lc3NhZ2UgPSAiIjsK
ICAgIHByaXZhdGUgbG9uZyBzdGF0dXNNZXNzYWdlVGltZSA9IDBMOwoKICAgIC8v
IE1lbnUgYmFyIHN0YXRlCiAgICBwcml2YXRlIGJvb2xlYW4gc2hvd01lbnVCYXIg
PSB0cnVlOwogICAgcHJpdmF0ZSBib29sZWFuIGZpbGVNZW51T3BlbiA9IGZhbHNl
OwogICAgcHJpdmF0ZSBpbnQgZmlsZU1lbnVXaWR0aCA9IDE4MCwgZmlsZU1lbnVJ
dGVtSGVpZ2h0ID0gMjI7CiAgICBwcml2YXRlIGludCBmaWxlTWVudVNlbGVjdGVk
ID0gLTE7CiAgICBwcml2YXRlIGZpbmFsIFN0cmluZ1tdIGZpbGVNZW51SXRlbXMg
PSBuZXcgU3RyaW5nW10gewogICAgICAgICJOZXciLCAiT3Blbi4uLiIsICJTYXZl
IiwgIlNhdmUgQXMuLi4iLCAiUHJpbnQuLi4iLCAiLSIsICJFeGl0IgogICAgfTsK
CiAgICBwcml2YXRlIHN0YXRpYyBGaWxlIGZpbGVUb09wZW4gPSBudWxsOwogICAg
cHVibGljIHN0YXRpYyB2b2lkIHNldEZpbGVUb09wZW4oRmlsZSBmKSB7IGZpbGVU
b09wZW4gPSBmOyB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBvbk9w
ZW4oRHJhZ2dhYmxlV2luZG93IHdpbmRvdykgewogICAgICAgIHRoaXMud2luZG93
ID0gd2luZG93OwogICAgICAgIGluaXRpYWxpemVDb21wb25lbnRzKCk7CiAgICAg
ICAgbG9hZFJlY2VudEZpbGVzKCk7CiAgICAgICAgaWYgKGZpbGVUb09wZW4gIT0g
bnVsbCkgeyBvcGVuRmlsZShmaWxlVG9PcGVuKTsgZmlsZVRvT3BlbiA9IG51bGw7
IH0KICAgICAgICBlbHNlIG5ld0RvY3VtZW50KCk7CiAgICB9CgogICAgcHJpdmF0
ZSB2b2lkIGluaXRpYWxpemVDb21wb25lbnRzKCkgewogICAgICAgIE1pbmVjcmFm
dCBtYyA9IE1pbmVjcmFmdC5nZXRJbnN0YW5jZSgpOwogICAgICAgIHRoaXMudGV4
dEFyZWEgPSBuZXcgRWRpdEJveChtYy5mb250LCAwLCAwLCAxMDAsIDE2LCBDb21w
b25lbnQuZW1wdHkoKSk7CiAgICAgICAgdGhpcy50ZXh0QXJlYS5zZXRNYXhMZW5n
dGgoSW50ZWdlci5NQVhfVkFMVUUpOwogICAgICAgIHRoaXMudGV4dEFyZWEuc2V0
Qm9yZGVyZWQoZmFsc2UpOwogICAgICAgIHRoaXMudGV4dEFyZWEuc2V0RWRpdGFi
bGUodHJ1ZSk7CiAgICAgICAgdGhpcy50ZXh0QXJlYS5zZXRSZXNwb25kZXIodGhp
czo6b25UZXh0Q2hhbmdlZCk7CgogICAgICAgIHRoaXMuc2F2ZUZpbGVOYW1lSW5w
dXQgPSBuZXcgRWRpdEJveChtYy5mb250LCAwLCAwLCAyMDAsIDE2LCBDb21wb25l
bnQuZW1wdHkoKSk7CiAgICAgICAgdGhpcy5zYXZlRmlsZU5hbWVJbnB1dC5zZXRN
YXhMZW5ndGgoMjU1KTsKICAgICAgICB0aGlzLmZpbGVQYXRoSW5wdXQgPSBuZXcg
RWRpdEJveChtYy5mb250LCAwLCAwLCAzMDAsIDE2LCBDb21wb25lbnQuZW1wdHko
KSk7CiAgICAgICAgdGhpcy5maWxlUGF0aElucHV0LnNldE1heExlbmd0aCg1MDAp
OwoKICAgICAgICB0aGlzLm9wZW5GaWxlTmFtZUlucHV0ID0gbmV3IEVkaXRCb3go
bWMuZm9udCwgMCwgMCwgMjAwLCAxNiwgQ29tcG9uZW50LmVtcHR5KCkpOwogICAg
ICAgIHRoaXMub3BlbkZpbGVOYW1lSW5wdXQuc2V0TWF4TGVuZ3RoKDI1NSk7CiAg
ICAgICAgdGhpcy5vcGVuRmlsZVBhdGhJbnB1dCA9IG5ldyBFZGl0Qm94KG1jLmZv
bnQsIDAsIDAsIDMwMCwgMTYsIENvbXBvbmVudC5lbXB0eSgpKTsKICAgICAgICB0
aGlzLm9wZW5GaWxlUGF0aElucHV0LnNldE1heExlbmd0aCg1MDApOwoKICAgICAg
ICBwdXNoVW5kb1N0YXRlKCk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIG9uVGV4
dENoYW5nZWQoU3RyaW5nIG5ld1RleHQpIHsKICAgICAgICBpZiAoIWlzTW9kaWZp
ZWQuZ2V0KCkpIHsKICAgICAgICAgICAgaXNNb2RpZmllZC5zZXQodHJ1ZSk7CiAg
ICAgICAgICAgIHVwZGF0ZVdpbmRvd1RpdGxlKCk7CiAgICAgICAgfQogICAgICAg
IHB1c2hVbmRvU3RhdGUoKTsKICAgICAgICByZWRvU3RhY2suY2xlYXIoKTsKICAg
IH0KCiAgICBwcml2YXRlIHZvaWQgdXBkYXRlV2luZG93VGl0bGUoKSB7CiAgICAg
ICAgaWYgKHdpbmRvdyA9PSBudWxsKSByZXR1cm47CiAgICAgICAgU3RyaW5nIGJh
c2UgPSBjdXJyZW50RmlsZS5nZXQoKSAhPSBudWxsID8gY3VycmVudEZpbGUuZ2V0
KCkuZ2V0TmFtZSgpIDogIlVudGl0bGVkIjsKICAgICAgICB3aW5kb3cuYXBwTmFt
ZSA9IGJhc2UgKyAoaXNNb2RpZmllZC5nZXQoKSA/ICIqIiA6ICIiKSArICIgLSBO
b3RlcGFkIjsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgbmV3RG9jdW1lbnQoKSB7
CiAgICAgICAgaWYgKCFjaGVja1NhdmVOZWVkZWQoKSkgcmV0dXJuOwogICAgICAg
IHRleHRBcmVhLnNldFZhbHVlKCIiKTsKICAgICAgICBjdXJyZW50RmlsZS5zZXQo
bnVsbCk7CiAgICAgICAgaXNNb2RpZmllZC5zZXQoZmFsc2UpOwogICAgICAgIHB1
c2hVbmRvU3RhdGUoKTsKICAgICAgICB1cGRhdGVXaW5kb3dUaXRsZSgpOwogICAg
ICAgIHNob3dTdGF0dXMoIk5ldyBkb2N1bWVudCIpOwogICAgfQoKICAgIHByaXZh
dGUgYm9vbGVhbiBjaGVja1NhdmVOZWVkZWQoKSB7CiAgICAgICAgaWYgKCFpc01v
ZGlmaWVkLmdldCgpKSByZXR1cm4gdHJ1ZTsKICAgICAgICBGaWxlIGYgPSBjdXJy
ZW50RmlsZS5nZXQoKTsKICAgICAgICBpZiAoZiAhPSBudWxsKSB7IGFzeW5jU2F2
ZURvY3VtZW50KGYpOyByZXR1cm4gdHJ1ZTsgfQogICAgICAgIHJldHVybiB0cnVl
OwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBvcGVuRmlsZShGaWxlIGZpbGUpIHsK
ICAgICAgICBhc3luY01hbmFnZXIuc3VibWl0SU9UYXNrKCgpIC0+IHsKICAgICAg
ICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGJ5dGVbXSBkYXRhID0gRmlsZXMu
cmVhZEFsbEJ5dGVzKGZpbGUudG9QYXRoKCkpOwogICAgICAgICAgICAgICAgU3Ry
aW5nIGNvbnRlbnQgPSBuZXcgU3RyaW5nKGRhdGEpOwogICAgICAgICAgICAgICAg
YXN5bmNNYW5hZ2VyLmV4ZWN1dGVPbk1haW5UaHJlYWQoKCkgLT4gewogICAgICAg
ICAgICAgICAgICAgIHRleHRBcmVhLnNldFZhbHVlKGNvbnRlbnQpOwogICAgICAg
ICAgICAgICAgICAgIGN1cnJlbnRGaWxlLnNldChmaWxlKTsKICAgICAgICAgICAg
ICAgICAgICBpc01vZGlmaWVkLnNldChmYWxzZSk7CiAgICAgICAgICAgICAgICAg
ICAgcHVzaFVuZG9TdGF0ZSgpOwogICAgICAgICAgICAgICAgICAgIHVwZGF0ZVdp
bmRvd1RpdGxlKCk7CiAgICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1cygiT3Bl
bmVkOiAiICsgZmlsZS5nZXROYW1lKCkpOwogICAgICAgICAgICAgICAgICAgIGFk
ZFJlY2VudChmaWxlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9
IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBhc3luY01h
bmFnZXIuZXhlY3V0ZU9uTWFpblRocmVhZCgoKSAtPiBzaG93U3RhdHVzKCJFcnJv
ciBvcGVuaW5nOiAiICsgZS5nZXRNZXNzYWdlKCkpKTsKICAgICAgICAgICAgfQog
ICAgICAgIH0pOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzYXZlRG9jdW1lbnQo
KSB7CiAgICAgICAgRmlsZSBmID0gY3VycmVudEZpbGUuZ2V0KCk7CiAgICAgICAg
aWYgKGYgPT0gbnVsbCkgewogICAgICAgICAgICBzaG93U2F2ZURpYWxvZyA9IHRy
dWU7CiAgICAgICAgICAgIHNhdmVGaWxlTmFtZUlucHV0LnNldFZhbHVlKCJVbnRp
dGxlZC50eHQiKTsKICAgICAgICAgICAgZmlsZVBhdGhJbnB1dC5zZXRWYWx1ZShu
ZXcgRmlsZShGaWxlc01hbmFnZXIuZ2V0UGxheWVyRGF0YURpcigpLCAiRG9jdW1l
bnRzIikuZ2V0QWJzb2x1dGVQYXRoKCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAg
ICAgICAgIGFzeW5jU2F2ZURvY3VtZW50KGYpOwogICAgICAgIH0KICAgIH0KCiAg
ICBwcml2YXRlIHZvaWQgYXN5bmNTYXZlRG9jdW1lbnQoRmlsZSBmaWxlKSB7CiAg
ICAgICAgYXN5bmNNYW5hZ2VyLnN1Ym1pdElPVGFzaygoKSAtPiB7CiAgICAgICAg
ICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoZmlsZS5nZXRQYXJlbnRGaWxl
KCkgIT0gbnVsbCkgZmlsZS5nZXRQYXJlbnRGaWxlKCkubWtkaXJzKCk7CiAgICAg
ICAgICAgICAgICBGaWxlcy53cml0ZShmaWxlLnRvUGF0aCgpLCB0ZXh0QXJlYS5n
ZXRWYWx1ZSgpLmdldEJ5dGVzKCksIFN0YW5kYXJkT3Blbk9wdGlvbi5DUkVBVEUs
IFN0YW5kYXJkT3Blbk9wdGlvbi5UUlVOQ0FURV9FWElTVElORyk7CiAgICAgICAg
ICAgICAgICBhc3luY01hbmFnZXIuZXhlY3V0ZU9uTWFpblRocmVhZCgoKSAtPiB7
CiAgICAgICAgICAgICAgICAgICAgY3VycmVudEZpbGUuc2V0KGZpbGUpOwogICAg
ICAgICAgICAgICAgICAgIGlzTW9kaWZpZWQuc2V0KGZhbHNlKTsKICAgICAgICAg
ICAgICAgICAgICB1cGRhdGVXaW5kb3dUaXRsZSgpOwogICAgICAgICAgICAgICAg
ICAgIHNob3dTdGF0dXMoIlNhdmVkOiAiICsgZmlsZS5nZXROYW1lKCkpOwogICAg
ICAgICAgICAgICAgICAgIHBsYXlTb3VuZChTb3VuZEV2ZW50cy5VSV9CVVRUT05f
Q0xJQ0suZ2V0KCkpOwogICAgICAgICAgICAgICAgICAgIGFkZFJlY2VudChmaWxl
KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGNhdGNoIChJT0V4
Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBhc3luY01hbmFnZXIuZXhlY3V0
ZU9uTWFpblRocmVhZCgoKSAtPiBzaG93U3RhdHVzKCJFcnJvciBzYXZpbmc6ICIg
KyBlLmdldE1lc3NhZ2UoKSkpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAg
ICB9CgogICAgcHJpdmF0ZSB2b2lkIHNob3dTdGF0dXMoU3RyaW5nIG0pIHsgc3Rh
dHVzTWVzc2FnZSA9IG07IHN0YXR1c01lc3NhZ2VUaW1lID0gU3lzdGVtLmN1cnJl
bnRUaW1lTWlsbGlzKCk7IH0KICAgIHByaXZhdGUgdm9pZCBwbGF5U291bmQobmV0
Lm1pbmVjcmFmdC5zb3VuZHMuU291bmRFdmVudCBzb3VuZCkgeyBNaW5lY3JhZnQu
Z2V0SW5zdGFuY2UoKS5nZXRTb3VuZE1hbmFnZXIoKS5wbGF5KFNpbXBsZVNvdW5k
SW5zdGFuY2UuZm9yVUkoc291bmQsIDEuMEYpKTsgfQoKICAgIC8vIHVuZG8vcmVk
bwogICAgcHJpdmF0ZSB2b2lkIHB1c2hVbmRvU3RhdGUoKSB7CiAgICAgICAgaWYg
KHRleHRBcmVhID09IG51bGwpIHJldHVybjsKICAgICAgICBTdHJpbmcgdiA9IHRl
eHRBcmVhLmdldFZhbHVlKCk7CiAgICAgICAgaWYgKHYgPT0gbnVsbCkgdiA9ICIi
OwogICAgICAgIGlmICh1bmRvU3RhY2suaXNFbXB0eSgpIHx8ICF1bmRvU3RhY2su
cGVlaygpLmVxdWFscyh2KSkgeyB1bmRvU3RhY2sucHVzaCh2KTsgd2hpbGUgKHVu
ZG9TdGFjay5zaXplKCkgPiAyMDApIHVuZG9TdGFjay5yZW1vdmVMYXN0KCk7IH0K
ICAgIH0KCiAgICBwcml2YXRlIHZvaWQgdW5kbygpIHsKICAgICAgICBpZiAodW5k
b1N0YWNrLnNpemUoKSA8PSAxKSByZXR1cm47CiAgICAgICAgU3RyaW5nIGN1ciA9
IHVuZG9TdGFjay5wb2xsKCk7IGlmIChjdXIgPT0gbnVsbCkgcmV0dXJuOyByZWRv
U3RhY2sucHVzaChjdXIpOyBTdHJpbmcgcHJldiA9IHVuZG9TdGFjay5wZWVrKCk7
IGlmIChwcmV2ICE9IG51bGwpIGFzeW5jTWFuYWdlci5leGVjdXRlT25NYWluVGhy
ZWFkKCgpIC0+IHRleHRBcmVhLnNldFZhbHVlKHByZXYpKTsKICAgIH0KCiAgICBw
cml2YXRlIHZvaWQgcmVkbygpIHsgaWYgKHJlZG9TdGFjay5pc0VtcHR5KCkpIHJl
dHVybjsgU3RyaW5nIG4gPSByZWRvU3RhY2sucG9wKCk7IHB1c2hVbmRvU3RhdGUo
KTsgYXN5bmNNYW5hZ2VyLmV4ZWN1dGVPbk1haW5UaHJlYWQoKCkgLT4gdGV4dEFy
ZWEuc2V0VmFsdWUobikpOyB9CgogICAgLy8gcmVjZW50IGZpbGVzCiAgICBwcml2
YXRlIHZvaWQgYWRkUmVjZW50KEZpbGUgZikgeyB0cnkgeyBTdHJpbmcgcCA9IGYu
Z2V0QWJzb2x1dGVQYXRoKCk7IHJlY2VudEZpbGVzLnJlbW92ZShwKTsgcmVjZW50
RmlsZXMuYWRkRmlyc3QocCk7IHdoaWxlIChyZWNlbnRGaWxlcy5zaXplKCkgPiAy
MCkgcmVjZW50RmlsZXMucmVtb3ZlTGFzdCgpOyBzYXZlUmVjZW50RmlsZXMoKTsg
fSBjYXRjaCAoRXhjZXB0aW9uIGlnbm9yZWQpIHt9IH0KICAgIHByaXZhdGUgdm9p
ZCBsb2FkUmVjZW50RmlsZXMoKSB7IHJlY2VudEZpbGVzLmNsZWFyKCk7IHRyeSB7
IGlmIChyZWNlbnRGaWxlc0ZpbGUuZXhpc3RzKCkpIHsgTGlzdDxTdHJpbmc+IGxp
bmVzID0gRmlsZXMucmVhZEFsbExpbmVzKHJlY2VudEZpbGVzRmlsZS50b1BhdGgo
KSk7IGZvciAoU3RyaW5nIGwgOiBsaW5lcykgaWYgKCFsLmlzQmxhbmsoKSkgcmVj
ZW50RmlsZXMuYWRkKGwpOyB9IH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlnbm9yZWQp
IHt9IH0KICAgIHByaXZhdGUgdm9pZCBzYXZlUmVjZW50RmlsZXMoKSB7IHRyeSB7
IGlmIChyZWNlbnRGaWxlc0ZpbGUuZ2V0UGFyZW50RmlsZSgpICE9IG51bGwpIHJl
Y2VudEZpbGVzRmlsZS5nZXRQYXJlbnRGaWxlKCkubWtkaXJzKCk7IHRyeSAoV3Jp
dGVyIHcgPSBuZXcgRmlsZVdyaXRlcihyZWNlbnRGaWxlc0ZpbGUsIGZhbHNlKSkg
eyBmb3IgKFN0cmluZyBzIDogcmVjZW50RmlsZXMpIHcud3JpdGUocyArICJcbiIp
OyB9IH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlnbm9yZWQpIHt9IH0KCiAgICBwcml2
YXRlIGludFtdIGdldEN1cnNvckxpbmVDb2woKSB7CiAgICAgICAgdHJ5IHsKICAg
ICAgICAgICAgaW50IGN1cnNvciA9IC0xOwogICAgICAgICAgICB0cnkgewogICAg
ICAgICAgICAgICAgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kIG0gPSBFZGl0Qm94
LmNsYXNzLmdldERlY2xhcmVkTWV0aG9kKCJnZXRDdXJzb3JQb3MiKTsKICAgICAg
ICAgICAgICAgIG0uc2V0QWNjZXNzaWJsZSh0cnVlKTsKICAgICAgICAgICAgICAg
IE9iamVjdCBvID0gbS5pbnZva2UodGV4dEFyZWEpOwogICAgICAgICAgICAgICAg
aWYgKG8gaW5zdGFuY2VvZiBJbnRlZ2VyKSBjdXJzb3IgPSAoSW50ZWdlcikgbzsK
ICAgICAgICAgICAgfSBjYXRjaCAoTm9TdWNoTWV0aG9kRXhjZXB0aW9uIG5zbWUp
IHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgamF2
YS5sYW5nLnJlZmxlY3QuTWV0aG9kIG0yID0gRWRpdEJveC5jbGFzcy5nZXREZWNs
YXJlZE1ldGhvZCgiZ2V0Q3Vyc29yUG9zaXRpb24iKTsKICAgICAgICAgICAgICAg
ICAgICBtMi5zZXRBY2Nlc3NpYmxlKHRydWUpOwogICAgICAgICAgICAgICAgICAg
IE9iamVjdCBvMiA9IG0yLmludm9rZSh0ZXh0QXJlYSk7CiAgICAgICAgICAgICAg
ICAgICAgaWYgKG8yIGluc3RhbmNlb2YgSW50ZWdlcikgY3Vyc29yID0gKEludGVn
ZXIpIG8yOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGlnbm9y
ZWQpIHt9CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7
fQoKICAgICAgICAgICAgU3RyaW5nIHMgPSB0ZXh0QXJlYS5nZXRWYWx1ZSgpOyBp
ZiAocyA9PSBudWxsKSBzID0gIiI7CiAgICAgICAgICAgIGlmIChjdXJzb3IgPCAw
KSBjdXJzb3IgPSBzLmxlbmd0aCgpOwoKICAgICAgICAgICAgaW50IGxpbmUgPSAx
LCBjb2wgPSAxLCBwb3MgPSAwOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsg
aSA8IHMubGVuZ3RoKCkgJiYgcG9zIDwgY3Vyc29yOyBpKyspIHsgY2hhciBjID0g
cy5jaGFyQXQoaSk7IHBvcysrOyBpZiAoYyA9PSAnXG4nKSB7IGxpbmUrKzsgY29s
ID0gMTsgfSBlbHNlIGNvbCsrOyB9CiAgICAgICAgICAgIHJldHVybiBuZXcgaW50
W117bGluZSwgY29sfTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgeyBy
ZXR1cm4gbmV3IGludFtdezEsMX07IH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg
IHB1YmxpYyB2b2lkIHJlbmRlckNvbnRlbnQoR3VpR3JhcGhpY3MgZ3VpR3JhcGhp
Y3MsIFBvc2VTdGFjayBwb3NlU3RhY2ssIERyYWdnYWJsZVdpbmRvdyB3aW5kb3cs
IGludCBtb3VzZVJlbFgsIGludCBtb3VzZVJlbFksIGZsb2F0IHBhcnRpYWxUaWNr
KSB7CiAgICAgICAgdGhpcy5tb3VzZVJlbFggPSBtb3VzZVJlbFg7IHRoaXMubW91
c2VSZWxZID0gbW91c2VSZWxZOwogICAgICAgIGludFtdIHIgPSB3aW5kb3cuZ2V0
UmVuZGVyUmVjdCgyNik7CiAgICAgICAgaW50IGN4ID0gclswXSArIDgsIGN5ID0g
clsxXSArIDI4LCBjdyA9IHJbMl0gLSAxNiwgY2ggPSByWzNdIC0gNDA7CiAgICAg
ICAgaW50IHRleHRZID0gY3kgKyAzMCwgdGV4dEhlaWdodCA9IGNoIC0gMzAgLSAy
MDsKCiAgICAgICAgLy8gTWVudSBiYXIKICAgICAgICBpZiAoc2hvd01lbnVCYXIp
IHsKICAgICAgICAgICAgZ3VpR3JhcGhpY3MuZmlsbChjeCwgY3ksIGN4ICsgY3cs
IGN5ICsgMjQsIDB4RkYyQjJCMkIpOwogICAgICAgICAgICBndWlHcmFwaGljcy5k
cmF3U3RyaW5nKE1pbmVjcmFmdC5nZXRJbnN0YW5jZSgpLmZvbnQsIENvbXBvbmVu
dC5saXRlcmFsKCJGaWxlIiksIGN4ICsgOCwgY3kgKyA2LCAweEZGRkZGRkZGLCBm
YWxzZSk7CiAgICAgICAgICAgIC8vIEZpbGUgbWVudSBkcm9wZG93bgogICAgICAg
ICAgICBpZiAoZmlsZU1lbnVPcGVuKSB7CiAgICAgICAgICAgICAgICBpbnQgbXgg
PSBjeCArIDgsIG15ID0gY3kgKyAyNDsKICAgICAgICAgICAgICAgIGludCBtZW51
SCA9IGZpbGVNZW51SXRlbUhlaWdodCAqIChmaWxlTWVudUl0ZW1zLmxlbmd0aCAr
IE1hdGgubWluKDUsIHJlY2VudEZpbGVzLnNpemUoKSkpOwogICAgICAgICAgICAg
ICAgZ3VpR3JhcGhpY3MuZmlsbChteCwgbXksIG14ICsgZmlsZU1lbnVXaWR0aCwg
bXkgKyBtZW51SCwgMHhGRjQ0NDQ0NCk7CiAgICAgICAgICAgICAgICBpbnQgaWR4
ID0gMDsKICAgICAgICAgICAgICAgIGZvciAoU3RyaW5nIGl0ZW0gOiBmaWxlTWVu
dUl0ZW1zKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uZXF1YWxzKCIt
IikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZ3VpR3JhcGhpY3MuZmlsbCht
eCwgbXkgKyBpZHggKiBmaWxlTWVudUl0ZW1IZWlnaHQsIG14ICsgZmlsZU1lbnVX
aWR0aCwgbXkgKyAoaWR4ICsgMSkgKiBmaWxlTWVudUl0ZW1IZWlnaHQsIDB4RkYy
MjIyMjIpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg
ICAgICAgICAgICAgIGludCBiZyA9IChmaWxlTWVudVNlbGVjdGVkID09IGlkeCkg
PyAweEZGNjY2NkFBIDogMHgwMDAwMDAwMDsKICAgICAgICAgICAgICAgICAgICAg
ICAgZ3VpR3JhcGhpY3MuZmlsbChteCwgbXkgKyBpZHggKiBmaWxlTWVudUl0ZW1I
ZWlnaHQsIG14ICsgZmlsZU1lbnVXaWR0aCwgbXkgKyAoaWR4ICsgMSkgKiBmaWxl
TWVudUl0ZW1IZWlnaHQsIGJnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZ3Vp
R3JhcGhpY3MuZHJhd1N0cmluZyhNaW5lY3JhZnQuZ2V0SW5zdGFuY2UoKS5mb250
LCBDb21wb25lbnQubGl0ZXJhbChpdGVtKSwgbXggKyA4LCBteSArIGlkeCAqIGZp
bGVNZW51SXRlbUhlaWdodCArIDQsIDB4RkZGRkZGRkYsIGZhbHNlKTsKICAgICAg
ICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWR4Kys7CiAgICAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBSZWNlbnQgZmlsZXMKICAg
ICAgICAgICAgICAgIGlmICghcmVjZW50RmlsZXMuaXNFbXB0eSgpKSB7CiAgICAg
ICAgICAgICAgICAgICAgZ3VpR3JhcGhpY3MuZHJhd1N0cmluZyhNaW5lY3JhZnQu
Z2V0SW5zdGFuY2UoKS5mb250LCBDb21wb25lbnQubGl0ZXJhbCgiUmVjZW50IGZp
bGVzOiIpLCBteCArIDgsIG15ICsgaWR4ICogZmlsZU1lbnVJdGVtSGVpZ2h0ICsg
MiwgMHhGRkFBQUFBQSwgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIGlkeCsr
OwogICAgICAgICAgICAgICAgICAgIGludCBySWR4ID0gMDsKICAgICAgICAgICAg
ICAgICAgICBmb3IgKFN0cmluZyByZiA6IHJlY2VudEZpbGVzKSB7CiAgICAgICAg
ICAgICAgICAgICAgICAgIGludCBiZyA9IChmaWxlTWVudVNlbGVjdGVkID09IGlk
eCkgPyAweEZGNjY2NkFBIDogMHgwMDAwMDAwMDsKICAgICAgICAgICAgICAgICAg
ICAgICAgZ3VpR3JhcGhpY3MuZmlsbChteCwgbXkgKyBpZHggKiBmaWxlTWVudUl0
ZW1IZWlnaHQsIG14ICsgZmlsZU1lbnVXaWR0aCwgbXkgKyAoaWR4ICsgMSkgKiBm
aWxlTWVudUl0ZW1IZWlnaHQsIGJnKTsKICAgICAgICAgICAgICAgICAgICAgICAg
U3RyaW5nIHNob3J0TmFtZSA9IG5ldyBGaWxlKHJmKS5nZXROYW1lKCk7CiAgICAg
ICAgICAgICAgICAgICAgICAgIGd1aUdyYXBoaWNzLmRyYXdTdHJpbmcoTWluZWNy
YWZ0LmdldEluc3RhbmNlKCkuZm9udCwgQ29tcG9uZW50LmxpdGVyYWwoc2hvcnRO
YW1lKSwgbXggKyAxNiwgbXkgKyBpZHggKiBmaWxlTWVudUl0ZW1IZWlnaHQgKyA0
LCAweEZGRkZGRkZGLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlk
eCsrOwogICAgICAgICAgICAgICAgICAgICAgICBySWR4Kys7CiAgICAgICAgICAg
ICAgICAgICAgICAgIGlmIChySWR4ID49IDUpIGJyZWFrOwogICAgICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAg
IH0KCiAgICAgICAgZ3VpR3JhcGhpY3MuZmlsbChjeCwgdGV4dFksIGN4ICsgY3cs
IHRleHRZICsgdGV4dEhlaWdodCwgMHhGRkVFRUVFRSk7CgogICAgICAgIHRleHRB
cmVhLnNldFgoY3ggKyAyKTsgdGV4dEFyZWEuc2V0WSh0ZXh0WSArIDIpOyB0ZXh0
QXJlYS5zZXRXaWR0aChjdyAtIDQpOyB0ZXh0QXJlYS5zZXRIZWlnaHQodGV4dEhl
aWdodCAtIDQpOwogICAgICAgIHRleHRBcmVhLnNldFRleHRDb2xvcigweEZGMDAw
MDAwKTsKICAgICAgICB0ZXh0QXJlYS5yZW5kZXIoZ3VpR3JhcGhpY3MsIChpbnQp
dGhpcy5tb3VzZVJlbFgsIChpbnQpdGhpcy5tb3VzZVJlbFksIHBhcnRpYWxUaWNr
KTsKCiAgICAgICAgaW50IHN0YXR1c1kgPSB0ZXh0WSArIHRleHRIZWlnaHQ7CiAg
ICAgICAgZ3VpR3JhcGhpY3MuZmlsbChjeCwgc3RhdHVzWSwgY3ggKyBjdywgc3Rh
dHVzWSArIDIwLCAweEZGMkIyQjJCKTsKICAgICAgICBpbnRbXSBsYyA9IGdldEN1
cnNvckxpbmVDb2woKTsKICAgICAgICBTdHJpbmcgbmFtZSA9IGN1cnJlbnRGaWxl
LmdldCgpICE9IG51bGwgPyBjdXJyZW50RmlsZS5nZXQoKS5nZXROYW1lKCkgOiAi
VW50aXRsZWQiOwogICAgICAgIGd1aUdyYXBoaWNzLmRyYXdTdHJpbmcoTWluZWNy
YWZ0LmdldEluc3RhbmNlKCkuZm9udCwgQ29tcG9uZW50LmxpdGVyYWwobmFtZSAr
IChpc01vZGlmaWVkLmdldCgpID8gIiAqIiA6ICIiKSArICIgIHwgIExuICIgKyBs
Y1swXSArICIsIENvbCAiICsgbGNbMV0pLCBjeCArIDUsIHN0YXR1c1kgKyA1LCAw
eEZGRkZGRkZGLCBmYWxzZSk7CiAgICAgICAgaWYgKFN5c3RlbS5jdXJyZW50VGlt
ZU1pbGxpcygpIC0gc3RhdHVzTWVzc2FnZVRpbWUgPCAzMDAwKSBndWlHcmFwaGlj
cy5kcmF3U3RyaW5nKE1pbmVjcmFmdC5nZXRJbnN0YW5jZSgpLmZvbnQsIENvbXBv
bmVudC5saXRlcmFsKHN0YXR1c01lc3NhZ2UpLCBjeCArIGN3IC0gMTAgLSBNaW5l
Y3JhZnQuZ2V0SW5zdGFuY2UoKS5mb250LndpZHRoKHN0YXR1c01lc3NhZ2UpLCBz
dGF0dXNZICsgNSwgMHhGRkZGRkZGRiwgZmFsc2UpOwoKICAgICAgICBpZiAoc2hv
d1NhdmVEaWFsb2cpIHJlbmRlclNhdmVEaWFsb2coZ3VpR3JhcGhpY3MsIGN4LCBj
eSwgY3csIGNoKTsKICAgICAgICBpZiAoc2hvd09wZW5EaWFsb2cpIHJlbmRlck9w
ZW5EaWFsb2coZ3VpR3JhcGhpY3MsIGN4LCBjeSwgY3csIGNoKTsKICAgICAgICBp
ZiAoc2hvd1NhdmVPbkV4aXREaWFsb2cpIHJlbmRlclNhdmVPbkV4aXREaWFsb2co
Z3VpR3JhcGhpY3MsIGN4LCBjeSwgY3csIGNoKTsKICAgIH0KCiAgICBwcml2YXRl
IHZvaWQgcmVuZGVyU2F2ZURpYWxvZyhHdWlHcmFwaGljcyBndWlHcmFwaGljcywg
aW50IGN4LCBpbnQgY3ksIGludCBjdywgaW50IGNoKSB7CiAgICAgICAgaW50IHcg
PSA0MjAsIGggPSAxNDA7CiAgICAgICAgaW50IHggPSBjeCArIChjdyAtIHcpIC8g
MjsKICAgICAgICBpbnQgeSA9IGN5ICsgKGNoIC0gaCkgLyAyOwogICAgICAgIGd1
aUdyYXBoaWNzLmZpbGwoeCwgeSwgeCArIHcsIHkgKyBoLCAweEZGMkIyQjJCKTsK
ICAgICAgICBndWlHcmFwaGljcy5maWxsKHgsIHksIHggKyB3LCB5ICsgMjAsIDB4
RkY0QzdCRDEpOwogICAgICAgIGd1aUdyYXBoaWNzLmRyYXdTdHJpbmcoTWluZWNy
YWZ0LmdldEluc3RhbmNlKCkuZm9udCwgQ29tcG9uZW50LmxpdGVyYWwoIlNhdmUg
RG9jdW1lbnQiKSwgeCArIDgsIHkgKyA2LCAweEZGRkZGRkZGLCBmYWxzZSk7Cgog
ICAgICAgIGd1aUdyYXBoaWNzLmRyYXdTdHJpbmcoTWluZWNyYWZ0LmdldEluc3Rh
bmNlKCkuZm9udCwgQ29tcG9uZW50LmxpdGVyYWwoIkZpbGUgbmFtZToiKSwgeCAr
IDgsIHkgKyAzNCwgMHhGRkZGRkZGRiwgZmFsc2UpOwogICAgICAgIHNhdmVGaWxl
TmFtZUlucHV0LnNldFgoeCArIDEwMCk7IHNhdmVGaWxlTmFtZUlucHV0LnNldFko
eSArIDMyKTsgc2F2ZUZpbGVOYW1lSW5wdXQuc2V0V2lkdGgodyAtIDIxMCk7IHNh
dmVGaWxlTmFtZUlucHV0LnJlbmRlcihndWlHcmFwaGljcywgKGludCltb3VzZVJl
bFgsIChpbnQpbW91c2VSZWxZLCAwKTsKCiAgICAgICAgZ3VpR3JhcGhpY3MuZHJh
d1N0cmluZyhNaW5lY3JhZnQuZ2V0SW5zdGFuY2UoKS5mb250LCBDb21wb25lbnQu
bGl0ZXJhbCgiU2F2ZSBpbjoiKSwgeCArIDgsIHkgKyA2MiwgMHhGRkZGRkZGRiwg
ZmFsc2UpOwogICAgICAgIGZpbGVQYXRoSW5wdXQuc2V0WCh4ICsgMTAwKTsgZmls
ZVBhdGhJbnB1dC5zZXRZKHkgKyA2MCk7IGZpbGVQYXRoSW5wdXQuc2V0V2lkdGgo
dyAtIDIxMCk7IGZpbGVQYXRoSW5wdXQucmVuZGVyKGd1aUdyYXBoaWNzLCAoaW50
KW1vdXNlUmVsWCwgKGludCltb3VzZVJlbFksIDApOwoKICAgICAgICBndWlHcmFw
aGljcy5maWxsKHggKyB3IC0gMTcwLCB5ICsgaCAtIDM2LCB4ICsgdyAtIDExMCwg
eSArIGggLSAxMiwgMHhGRjg4ODg4OCk7CiAgICAgICAgZ3VpR3JhcGhpY3MuZHJh
d1N0cmluZyhNaW5lY3JhZnQuZ2V0SW5zdGFuY2UoKS5mb250LCBDb21wb25lbnQu
bGl0ZXJhbCgiQ2FuY2VsIiksIHggKyB3IC0gMTU4LCB5ICsgaCAtIDMyLCAweEZG
RkZGRkZGLCBmYWxzZSk7CiAgICAgICAgZ3VpR3JhcGhpY3MuZmlsbCh4ICsgdyAt
IDEwMCwgeSArIGggLSAzNiwgeCArIHcgLSA0MCwgeSArIGggLSAxMiwgMHhGRjRD
QUY1MCk7CiAgICAgICAgZ3VpR3JhcGhpY3MuZHJhd1N0cmluZyhNaW5lY3JhZnQu
Z2V0SW5zdGFuY2UoKS5mb250LCBDb21wb25lbnQubGl0ZXJhbCgiU2F2ZSIpLCB4
ICsgdyAtIDkwLCB5ICsgaCAtIDMyLCAweEZGRkZGRkZGLCBmYWxzZSk7CiAgICB9
CgogICAgcHJpdmF0ZSB2b2lkIHJlbmRlck9wZW5EaWFsb2coR3VpR3JhcGhpY3Mg
Z3VpR3JhcGhpY3MsIGludCBjeCwgaW50IGN5LCBpbnQgY3csIGludCBjaCkgewog
ICAgICAgIGludCB3ID0gNDIwLCBoID0gMTQwOwogICAgICAgIGludCB4ID0gY3gg
KyAoY3cgLSB3KSAvIDI7CiAgICAgICAgaW50IHkgPSBjeSArIChjaCAtIGgpIC8g
MjsKICAgICAgICBndWlHcmFwaGljcy5maWxsKHgsIHksIHggKyB3LCB5ICsgaCwg
MHhGRjJCMkIyQik7CiAgICAgICAgZ3VpR3JhcGhpY3MuZmlsbCh4LCB5LCB4ICsg
dywgeSArIDIwLCAweEZGNEM3QkQxKTsKICAgICAgICBndWlHcmFwaGljcy5kcmF3
U3RyaW5nKE1pbmVjcmFmdC5nZXRJbnN0YW5jZSgpLmZvbnQsIENvbXBvbmVudC5s
aXRlcmFsKCJPcGVuIERvY3VtZW50IiksIHggKyA4LCB5ICsgNiwgMHhGRkZGRkZG
RiwgZmFsc2UpOwoKICAgICAgICBndWlHcmFwaGljcy5kcmF3U3RyaW5nKE1pbmVj
cmFmdC5nZXRJbnN0YW5jZSgpLmZvbnQsIENvbXBvbmVudC5saXRlcmFsKCJGaWxl
IG5hbWU6IiksIHggKyA4LCB5ICsgMzQsIDB4RkZGRkZGRkYsIGZhbHNlKTsKICAg
ICAgICBvcGVuRmlsZU5hbWVJbnB1dC5zZXRYKHggKyAxMDApOyBvcGVuRmlsZU5h
bWVJbnB1dC5zZXRZKHkgKyAzMik7IG9wZW5GaWxlTmFtZUlucHV0LnNldFdpZHRo
KHcgLSAyMTApOyBvcGVuRmlsZU5hbWVJbnB1dC5yZW5kZXIoZ3VpR3JhcGhpY3Ms
IChpbnQpbW91c2VSZWxYLCAoaW50KW1vdXNlUmVsWSwgMCk7CgogICAgICAgIGd1
aUdyYXBoaWNzLmRyYXdTdHJpbmcoTWluZWNyYWZ0LmdldEluc3RhbmNlKCkuZm9u
dCwgQ29tcG9uZW50LmxpdGVyYWwoIk9wZW4gZnJvbToiKSwgeCArIDgsIHkgKyA2
MiwgMHhGRkZGRkZGRiwgZmFsc2UpOwogICAgICAgIG9wZW5GaWxlUGF0aElucHV0
LnNldFgoeCArIDEwMCk7IG9wZW5GaWxlUGF0aElucHV0LnNldFkoeSArIDYwKTsg
b3BlbkZpbGVQYXRoSW5wdXQuc2V0V2lkdGgodyAtIDIxMCk7IG9wZW5GaWxlUGF0
aElucHV0LnJlbmRlcihndWlHcmFwaGljcywgKGludCltb3VzZVJlbFgsIChpbnQp
bW91c2VSZWxZLCAwKTsKCiAgICAgICAgZ3VpR3JhcGhpY3MuZmlsbCh4ICsgdyAt
IDE3MCwgeSArIGggLSAzNiwgeCArIHcgLSAxMTAsIHkgKyBoIC0gMTIsIDB4RkY4
ODg4ODgpOwogICAgICAgIGd1aUdyYXBoaWNzLmRyYXdTdHJpbmcoTWluZWNyYWZ0
LmdldEluc3RhbmNlKCkuZm9udCwgQ29tcG9uZW50LmxpdGVyYWwoIkNhbmNlbCIp
LCB4ICsgdyAtIDE1OCwgeSArIGggLSAzMiwgMHhGRkZGRkZGRiwgZmFsc2UpOwog
ICAgICAgIGd1aUdyYXBoaWNzLmZpbGwoeCArIHcgLSAxMDAsIHkgKyBoIC0gMzYs
IHggKyB3IC0gNDAsIHkgKyBoIC0gMTIsIDB4RkY0Q0FGNTApOwogICAgICAgIGd1
aUdyYXBoaWNzLmRyYXdTdHJpbmcoTWluZWNyYWZ0LmdldEluc3RhbmNlKCkuZm9u
dCwgQ29tcG9uZW50LmxpdGVyYWwoIk9wZW4iKSwgeCArIHcgLSA5MCwgeSArIGgg
LSAzMiwgMHhGRkZGRkZGRiwgZmFsc2UpOwogICAgfQoKICAgIHByaXZhdGUgdm9p
ZCByZW5kZXJTYXZlT25FeGl0RGlhbG9nKEd1aUdyYXBoaWNzIGd1aUdyYXBoaWNz
LCBpbnQgY3gsIGludCBjeSwgaW50IGN3LCBpbnQgY2gpIHsKICAgICAgICBpbnQg
dyA9IDM0MCwgaCA9IDEwMDsKICAgICAgICBpbnQgeCA9IGN4ICsgKGN3IC0gdykg
LyAyOwogICAgICAgIGludCB5ID0gY3kgKyAoY2ggLSBoKSAvIDI7CiAgICAgICAg
Z3VpR3JhcGhpY3MuZmlsbCh4LCB5LCB4ICsgdywgeSArIGgsIDB4RkYyQjJCMkIp
OwogICAgICAgIGd1aUdyYXBoaWNzLmRyYXdTdHJpbmcoTWluZWNyYWZ0LmdldElu
c3RhbmNlKCkuZm9udCwgQ29tcG9uZW50LmxpdGVyYWwoIlNhdmUgY2hhbmdlcyBi
ZWZvcmUgZXhpdGluZz8iKSwgeCArIDE2LCB5ICsgMTgsIDB4RkZGRkZGRkYsIGZh
bHNlKTsKICAgICAgICBndWlHcmFwaGljcy5maWxsKHggKyAyMCwgeSArIGggLSAz
NiwgeCArIDEwMCwgeSArIGggLSAxMiwgMHhGRjRDQUY1MCk7CiAgICAgICAgZ3Vp
R3JhcGhpY3MuZHJhd1N0cmluZyhNaW5lY3JhZnQuZ2V0SW5zdGFuY2UoKS5mb250
LCBDb21wb25lbnQubGl0ZXJhbCgiU2F2ZSIpLCB4ICsgMzYsIHkgKyBoIC0gMzIs
IDB4RkZGRkZGRkYsIGZhbHNlKTsKICAgICAgICBndWlHcmFwaGljcy5maWxsKHgg
KyAxMjAsIHkgKyBoIC0gMzYsIHggKyAyMDAsIHkgKyBoIC0gMTIsIDB4RkY4ODg4
ODgpOwogICAgICAgIGd1aUdyYXBoaWNzLmRyYXdTdHJpbmcoTWluZWNyYWZ0Lmdl
dEluc3RhbmNlKCkuZm9udCwgQ29tcG9uZW50LmxpdGVyYWwoIkRvbid0IFNhdmUi
KSwgeCArIDEyNiwgeSArIGggLSAzMiwgMHhGRkZGRkZGRiwgZmFsc2UpOwogICAg
ICAgIGd1aUdyYXBoaWNzLmZpbGwoeCArIDIyMCwgeSArIGggLSAzNiwgeCArIDMw
MCwgeSArIGggLSAxMiwgMHhGRjg4ODg4OCk7CiAgICAgICAgZ3VpR3JhcGhpY3Mu
ZHJhd1N0cmluZyhNaW5lY3JhZnQuZ2V0SW5zdGFuY2UoKS5mb250LCBDb21wb25l
bnQubGl0ZXJhbCgiQ2FuY2VsIiksIHggKyAyMzYsIHkgKyBoIC0gMzIsIDB4RkZG
RkZGRkYsIGZhbHNlKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBi
b29sZWFuIG1vdXNlQ2xpY2tlZChEcmFnZ2FibGVXaW5kb3cgd2luZG93LCBkb3Vi
bGUgbW91c2VSZWxYLCBkb3VibGUgbW91c2VSZWxZLCBpbnQgYnV0dG9uKSB7CiAg
ICAgICAgdGhpcy5tb3VzZVJlbFggPSBtb3VzZVJlbFg7IHRoaXMubW91c2VSZWxZ
ID0gbW91c2VSZWxZOwogICAgICAgIGlmIChzaG93U2F2ZURpYWxvZykgewogICAg
ICAgICAgICBpbnRbXSByID0gd2luZG93LmdldFJlbmRlclJlY3QoMjYpOwogICAg
ICAgICAgICBpbnQgY3ggPSByWzBdICsgOCwgY3kgPSByWzFdICsgMjgsIGN3ID0g
clsyXSAtIDE2LCBjaCA9IHJbM10gLSA0MDsKICAgICAgICAgICAgLy8gZGlhbG9n
IHNpemUKICAgICAgICAgICAgaW50IHcgPSA0MjAsIGggPSAxNDA7CiAgICAgICAg
ICAgIGludCB4ID0gY3ggKyAoY3cgLSB3KSAvIDI7CiAgICAgICAgICAgIGludCB5
ID0gY3kgKyAoY2ggLSBoKSAvIDI7CiAgICAgICAgICAgIC8vIENhbmNlbCBidXR0
b24gYXJlYQogICAgICAgICAgICBpZiAobW91c2VSZWxYID49IHggKyB3IC0gMTcw
ICYmIG1vdXNlUmVsWCA8PSB4ICsgdyAtIDExMCAmJiBtb3VzZVJlbFkgPj0geSAr
IGggLSAzNiAmJiBtb3VzZVJlbFkgPD0geSArIGggLSAxMikgewogICAgICAgICAg
ICAgICAgLy8gQ2FuY2VsIGJ1dHRvbgogICAgICAgICAgICAgICAgc2hvd1NhdmVE
aWFsb2cgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg
ICAgICAgICB9CiAgICAgICAgICAgIC8vIFNhdmUgYnV0dG9uIGFyZWEKICAgICAg
ICAgICAgaWYgKG1vdXNlUmVsWCA+PSB4ICsgdyAtIDEwMCAmJiBtb3VzZVJlbFgg
PD0geCArIHcgLSA0MCAmJiBtb3VzZVJlbFkgPj0geSArIGggLSAzNiAmJiBtb3Vz
ZVJlbFkgPD0geSArIGggLSAxMikgewogICAgICAgICAgICAgICAgLy8gU2F2ZSBi
dXR0b24KICAgICAgICAgICAgICAgIFN0cmluZyBmaWxlTmFtZSA9IHNhdmVGaWxl
TmFtZUlucHV0LmdldFZhbHVlKCkudHJpbSgpOwogICAgICAgICAgICAgICAgU3Ry
aW5nIGZpbGVQYXRoID0gZmlsZVBhdGhJbnB1dC5nZXRWYWx1ZSgpLnRyaW0oKTsK
ICAgICAgICAgICAgICAgIGlmIChmaWxlTmFtZS5pc0VtcHR5KCkgfHwgZmlsZVBh
dGguaXNFbXB0eSgpKSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1cygi
RmlsZSBuYW1lIGFuZCBwYXRoIGNhbm5vdCBiZSBlbXB0eSIpOwogICAgICAgICAg
ICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBGaWxlIGRpciA9IG5l
dyBGaWxlKGZpbGVQYXRoKTsKICAgICAgICAgICAgICAgICAgICBpZiAoIWRpci5l
eGlzdHMoKSB8fCAhZGlyLmlzRGlyZWN0b3J5KCkpIHsKICAgICAgICAgICAgICAg
ICAgICAgICAgc2hvd1N0YXR1cygiSW52YWxpZCBkaXJlY3Rvcnk6ICIgKyBmaWxl
UGF0aCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg
ICAgICAgICAgICAgRmlsZSBzYXZlRmlsZSA9IG5ldyBGaWxlKGRpciwgZmlsZU5h
bWUpOwogICAgICAgICAgICAgICAgICAgICAgICBhc3luY1NhdmVEb2N1bWVudChz
YXZlRmlsZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dTYXZlRGlhbG9n
ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
fQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAg
ICAgICB9CiAgICAgICAgaWYgKHNob3dPcGVuRGlhbG9nKSB7CiAgICAgICAgICAg
IGludFtdIHIgPSB3aW5kb3cuZ2V0UmVuZGVyUmVjdCgyNik7CiAgICAgICAgICAg
IGludCBjeCA9IHJbMF0gKyA4LCBjeSA9IHJbMV0gKyAyOCwgY3cgPSByWzJdIC0g
MTYsIGNoID0gclszXSAtIDQwOwogICAgICAgICAgICBpbnQgdyA9IDQyMCwgaCA9
IDE0MDsKICAgICAgICAgICAgaW50IHggPSBjeCArIChjdyAtIHcpIC8gMjsKICAg
ICAgICAgICAgaW50IHkgPSBjeSArIChjaCAtIGgpIC8gMjsKICAgICAgICAgICAg
Ly8gQ2FuY2VsCiAgICAgICAgICAgIGlmIChtb3VzZVJlbFggPj0geCArIHcgLSAx
NzAgJiYgbW91c2VSZWxYIDw9IHggKyB3IC0gMTEwICYmIG1vdXNlUmVsWSA+PSB5
ICsgaCAtIDM2ICYmIG1vdXNlUmVsWSA8PSB5ICsgaCAtIDEyKSB7CiAgICAgICAg
ICAgICAgICBzaG93T3BlbkRpYWxvZyA9IGZhbHNlOwogICAgICAgICAgICAgICAg
cmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gT3Blbgog
ICAgICAgICAgICBpZiAobW91c2VSZWxYID49IHggKyB3IC0gMTAwICYmIG1vdXNl
UmVsWCA8PSB4ICsgdyAtIDQwICYmIG1vdXNlUmVsWSA+PSB5ICsgaCAtIDM2ICYm
IG1vdXNlUmVsWSA8PSB5ICsgaCAtIDEyKSB7CiAgICAgICAgICAgICAgICBTdHJp
bmcgZmlsZU5hbWUgPSBvcGVuRmlsZU5hbWVJbnB1dC5nZXRWYWx1ZSgpLnRyaW0o
KTsKICAgICAgICAgICAgICAgIFN0cmluZyBmaWxlUGF0aCA9IG9wZW5GaWxlUGF0
aElucHV0LmdldFZhbHVlKCkudHJpbSgpOwogICAgICAgICAgICAgICAgaWYgKGZp
bGVOYW1lLmlzRW1wdHkoKSB8fCBmaWxlUGF0aC5pc0VtcHR5KCkpIHsKICAgICAg
ICAgICAgICAgICAgICBzaG93U3RhdHVzKCJGaWxlIG5hbWUgYW5kIHBhdGggY2Fu
bm90IGJlIGVtcHR5Iik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAg
ICAgICAgICAgICAgIEZpbGUgZGlyID0gbmV3IEZpbGUoZmlsZVBhdGgpOwogICAg
ICAgICAgICAgICAgICAgIEZpbGUgb3BlbkZpbGUgPSBuZXcgRmlsZShkaXIsIGZp
bGVOYW1lKTsKICAgICAgICAgICAgICAgICAgICBpZiAoIW9wZW5GaWxlLmV4aXN0
cygpIHx8ICFvcGVuRmlsZS5pc0ZpbGUoKSkgewogICAgICAgICAgICAgICAgICAg
ICAgICBzaG93U3RhdHVzKCJGaWxlIGRvZXMgbm90IGV4aXN0OiAiICsgb3BlbkZp
bGUuZ2V0QWJzb2x1dGVQYXRoKCkpOwogICAgICAgICAgICAgICAgICAgIH0gZWxz
ZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5GaWxlKG9wZW5GaWxlKTsK
ICAgICAgICAgICAgICAgICAgICAgICAgc2hvd09wZW5EaWFsb2cgPSBmYWxzZTsK
ICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg
ICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg
ICAgICBpZiAoc2hvd1NhdmVPbkV4aXREaWFsb2cpIHsKICAgICAgICAgICAgaW50
W10gciA9IHdpbmRvdy5nZXRSZW5kZXJSZWN0KDI2KTsKICAgICAgICAgICAgaW50
IGN4ID0gclswXSArIDgsIGN5ID0gclsxXSArIDI4LCBjdyA9IHJbMl0gLSAxNiwg
Y2ggPSByWzNdIC0gNDA7CiAgICAgICAgICAgIGludCB3ID0gMzQwLCBoID0gMTAw
OwogICAgICAgICAgICBpbnQgeCA9IGN4ICsgKGN3IC0gdykgLyAyOwogICAgICAg
ICAgICBpbnQgeSA9IGN5ICsgKGNoIC0gaCkgLyAyOwogICAgICAgICAgICAvLyBT
YXZlCiAgICAgICAgICAgIGlmIChtb3VzZVJlbFggPj0geCArIDIwICYmIG1vdXNl
UmVsWCA8PSB4ICsgMTAwICYmIG1vdXNlUmVsWSA+PSB5ICsgaCAtIDM2ICYmIG1v
dXNlUmVsWSA8PSB5ICsgaCAtIDEyKSB7CiAgICAgICAgICAgICAgICBzYXZlRG9j
dW1lbnQoKTsKICAgICAgICAgICAgICAgIHNob3dTYXZlT25FeGl0RGlhbG9nID0g
ZmFsc2U7CiAgICAgICAgICAgICAgICBNaW5lY3JhZnQuZ2V0SW5zdGFuY2UoKS5z
ZXRTY3JlZW4obnVsbCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAg
ICAgICAgICAgfQogICAgICAgICAgICAvLyBEb24ndCBTYXZlCiAgICAgICAgICAg
IGlmIChtb3VzZVJlbFggPj0geCArIDEyMCAmJiBtb3VzZVJlbFggPD0geCArIDIw
MCAmJiBtb3VzZVJlbFkgPj0geSArIGggLSAzNiAmJiBtb3VzZVJlbFkgPD0geSAr
IGggLSAxMikgewogICAgICAgICAgICAgICAgc2hvd1NhdmVPbkV4aXREaWFsb2cg
PSBmYWxzZTsKICAgICAgICAgICAgICAgIE1pbmVjcmFmdC5nZXRJbnN0YW5jZSgp
LnNldFNjcmVlbihudWxsKTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwog
ICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIENhbmNlbAogICAgICAgICAgICBp
ZiAobW91c2VSZWxYID49IHggKyAyMjAgJiYgbW91c2VSZWxYIDw9IHggKyAzMDAg
JiYgbW91c2VSZWxZID49IHkgKyBoIC0gMzYgJiYgbW91c2VSZWxZIDw9IHkgKyBo
IC0gMTIpIHsKICAgICAgICAgICAgICAgIHNob3dTYXZlT25FeGl0RGlhbG9nID0g
ZmFsc2U7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAg
fQogICAgICAgIH0KICAgICAgICAvLyBNZW51IGJhcgogICAgICAgIGlmIChzaG93
TWVudUJhcikgewogICAgICAgICAgICBpbnRbXSByID0gd2luZG93LmdldFJlbmRl
clJlY3QoMjYpOwogICAgICAgICAgICBpbnQgY3ggPSByWzBdICsgOCwgY3kgPSBy
WzFdICsgMjgsIGN3ID0gclsyXSAtIDE2LCBjaCA9IHJbM10gLSA0MDsKICAgICAg
ICAgICAgaW50IG14ID0gY3ggKyA4LCBteSA9IGN5ICsgMjQ7CiAgICAgICAgICAg
IC8vIEZpbGUgbWVudQogICAgICAgICAgICBpZiAobW91c2VSZWxYID49IGN4ICsg
OCAmJiBtb3VzZVJlbFggPD0gY3ggKyA4ICsgZmlsZU1lbnVXaWR0aCAmJiBtb3Vz
ZVJlbFkgPj0gY3kgKyAyNCAmJiBtb3VzZVJlbFkgPD0gY3kgKyAyNCArIGZpbGVN
ZW51SXRlbUhlaWdodCkgewogICAgICAgICAgICAgICAgZmlsZU1lbnVPcGVuID0g
IWZpbGVNZW51T3BlbjsKICAgICAgICAgICAgICAgIGZpbGVNZW51U2VsZWN0ZWQg
PSAtMTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9
CiAgICAgICAgICAgIC8vIEZpbGUgbWVudSBpdGVtcwogICAgICAgICAgICBpZiAo
ZmlsZU1lbnVPcGVuKSB7CiAgICAgICAgICAgICAgICBpbnQgbWVudUggPSBmaWxl
TWVudUl0ZW1IZWlnaHQgKiAoZmlsZU1lbnVJdGVtcy5sZW5ndGggKyBNYXRoLm1p
big1LCByZWNlbnRGaWxlcy5zaXplKCkpKTsKICAgICAgICAgICAgICAgIGlmICht
b3VzZVJlbFkgPj0gbXkgJiYgbW91c2VSZWxZIDw9IG15ICsgbWVudUgpIHsKICAg
ICAgICAgICAgICAgICAgICAvLyBjYXN0IHRvIGludCBiZWNhdXNlIG1vdXNlUmVs
WSBhbmQgbXkgYXJlIGRvdWJsZXMKICAgICAgICAgICAgICAgICAgICBpbnQgaWR4
ID0gKGludCkgKChtb3VzZVJlbFkgLSBteSkgLyBmaWxlTWVudUl0ZW1IZWlnaHQp
OwogICAgICAgICAgICAgICAgICAgIGlmIChpZHggPCBmaWxlTWVudUl0ZW1zLmxl
bmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICBmaWxlTWVudVNlbGVjdGVk
ID0gaWR4OwogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGlkeCkgewog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiBuZXdEb2N1bWVudCgp
OyBmaWxlTWVudU9wZW4gPSBmYWxzZTsgcmV0dXJuIHRydWU7IC8vIE5ldwogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiBzaG93T3BlbkRpYWxvZygp
OyBmaWxlTWVudU9wZW4gPSBmYWxzZTsgcmV0dXJuIHRydWU7IC8vIE9wZW4KICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogc2F2ZURvY3VtZW50KCk7
IGZpbGVNZW51T3BlbiA9IGZhbHNlOyByZXR1cm4gdHJ1ZTsgLy8gU2F2ZQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiBzaG93U2F2ZURpYWxvZyA9
IHRydWU7IGZpbGVNZW51T3BlbiA9IGZhbHNlOyByZXR1cm4gdHJ1ZTsgLy8gU2F2
ZSBBcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiBzaG93U3Rh
dHVzKCJQcmludCBpcyBub3QgaW1wbGVtZW50ZWQiKTsgZmlsZU1lbnVPcGVuID0g
ZmFsc2U7IHJldHVybiB0cnVlOyAvLyBQcmludAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY2FzZSA2OiBoYW5kbGVFeGl0KCk7IGZpbGVNZW51T3BlbiA9IGZh
bHNlOyByZXR1cm4gdHJ1ZTsgLy8gRXhpdAogICAgICAgICAgICAgICAgICAgICAg
ICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg
ICAgICAgICAgLy8gUmVjZW50IGZpbGVzCiAgICAgICAgICAgICAgICAgICAgICAg
IGlkeCAtPSBmaWxlTWVudUl0ZW1zLmxlbmd0aDsKICAgICAgICAgICAgICAgICAg
ICAgICAgaWYgKGlkeCA8IHJlY2VudEZpbGVzLnNpemUoKSkgewogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgRmlsZSByZWNlbnRGaWxlID0gbmV3IEZpbGUocmVj
ZW50RmlsZXMuZ2V0KGlkeCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg
b3BlbkZpbGUocmVjZW50RmlsZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBmaWxlTWVudU9wZW4gPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAg
ICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9
CiAgICAgICAgfQogICAgICAgIHJldHVybiB0ZXh0QXJlYSAhPSBudWxsICYmIHRl
eHRBcmVhLm1vdXNlQ2xpY2tlZChtb3VzZVJlbFgsIG1vdXNlUmVsWSwgYnV0dG9u
KTsKICAgIH0KCiAgICAvLyBTaG93IG9wZW4gZGlhbG9nIChzdHViIGZvciBub3cp
CiAgICBwcml2YXRlIHZvaWQgc2hvd09wZW5EaWFsb2coKSB7CiAgICAgICAgb3Bl
bkZpbGVOYW1lSW5wdXQuc2V0VmFsdWUoIiIpOwogICAgICAgIG9wZW5GaWxlUGF0
aElucHV0LnNldFZhbHVlKG5ldyBGaWxlKEZpbGVzTWFuYWdlci5nZXRQbGF5ZXJE
YXRhRGlyKCksICJEb2N1bWVudHMiKS5nZXRBYnNvbHV0ZVBhdGgoKSk7CiAgICAg
ICAgc2hvd09wZW5EaWFsb2cgPSB0cnVlOwogICAgfQoKICAgIC8vIFByb21wdCB0
byBzYXZlIG9uIGV4aXQgaWYgbmVlZGVkCiAgICBwcml2YXRlIHZvaWQgaGFuZGxl
RXhpdCgpIHsKICAgICAgICBpZiAoaXNNb2RpZmllZC5nZXQoKSkgewogICAgICAg
ICAgICBzaG93U2F2ZU9uRXhpdERpYWxvZyA9IHRydWU7CiAgICAgICAgfSBlbHNl
IHsKICAgICAgICAgICAgTWluZWNyYWZ0LmdldEluc3RhbmNlKCkuc2V0U2NyZWVu
KG51bGwpOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp
YyBib29sZWFuIGtleVByZXNzZWQoRHJhZ2dhYmxlV2luZG93IHdpbmRvdywgaW50
IGtleUNvZGUsIGludCBzY2FuQ29kZSwgaW50IG1vZGlmaWVycykgewogICAgICAg
IC8vIEtleWJvYXJkIHNob3J0Y3V0cyBmb3IgRmlsZSBtZW51CiAgICAgICAgYm9v
bGVhbiBjdHJsID0gKG1vZGlmaWVycyAmIDB4MikgIT0gMDsKICAgICAgICBpZiAo
Y3RybCkgewogICAgICAgICAgICBzd2l0Y2ggKGtleUNvZGUpIHsKICAgICAgICAg
ICAgICAgIGNhc2UgNDY6IG5ld0RvY3VtZW50KCk7IHJldHVybiB0cnVlOyAvLyBD
dHJsK04KICAgICAgICAgICAgICAgIGNhc2UgNDc6IHNob3dPcGVuRGlhbG9nKCk7
IHJldHVybiB0cnVlOyAvLyBDdHJsK08KICAgICAgICAgICAgICAgIGNhc2UgMzE6
IHNhdmVEb2N1bWVudCgpOyByZXR1cm4gdHJ1ZTsgLy8gQ3RybCtTCiAgICAgICAg
ICAgICAgICBjYXNlIDQ4OiBzaG93U2F2ZURpYWxvZyA9IHRydWU7IHJldHVybiB0
cnVlOyAvLyBDdHJsK1AgKFByaW50KQogICAgICAgICAgICB9CiAgICAgICAgfQog
ICAgICAgIHJldHVybiB0ZXh0QXJlYSAhPSBudWxsICYmIHRleHRBcmVhLmtleVBy
ZXNzZWQoa2V5Q29kZSwgc2NhbkNvZGUsIG1vZGlmaWVycyk7CiAgICB9CgogICAg
QE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBtb3VzZVJlbGVhc2VkKERyYWdnYWJs
ZVdpbmRvdyB3aW5kb3csIGRvdWJsZSBtb3VzZVJlbFgsIGRvdWJsZSBtb3VzZVJl
bFksIGludCBidXR0b24pIHsKICAgICAgICBpZiAodGV4dEFyZWEgIT0gbnVsbCkg
dGV4dEFyZWEubW91c2VSZWxlYXNlZChtb3VzZVJlbFgsIG1vdXNlUmVsWSwgYnV0
dG9uKTsKICAgIH0KICAgIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xlYW4gbW91
c2VEcmFnZ2VkKERyYWdnYWJsZVdpbmRvdyB3aW5kb3csIGRvdWJsZSBtb3VzZVJl
bFgsIGRvdWJsZSBtb3VzZVJlbFksIGRvdWJsZSBkeCwgZG91YmxlIGR5KSB7CiAg
ICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgQE92ZXJyaWRlCiAgICBwdWJs
aWMgYm9vbGVhbiBjaGFyVHlwZWQoRHJhZ2dhYmxlV2luZG93IHdpbmRvdywgY2hh
ciBjb2RlUG9pbnQsIGludCBtb2RpZmllcnMpIHsKICAgICAgICByZXR1cm4gdGV4
dEFyZWEgIT0gbnVsbCAmJiB0ZXh0QXJlYS5jaGFyVHlwZWQoY29kZVBvaW50LCBt
b2RpZmllcnMpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQg
b25DbG9zZShEcmFnZ2FibGVXaW5kb3cgd2luZG93KSB7CiAgICAgICAgLy8gbm90
aGluZyB0byBkbyBmb3IgbWluaW1hbCBpbXBsZW1lbnRhdGlvbgogICAgfQoKICAg
IEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgdGljaygpIHsKICAgICAgICBpZiAo
dGV4dEFyZWEgIT0gbnVsbCkgdGV4dEFyZWEudGljaygpOwogICAgfQp9Cg==
